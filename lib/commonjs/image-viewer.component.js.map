{"version":3,"sources":["image-viewer.component.tsx"],"names":["ImageViewer","React","Component","State","Animated","Value","Map","index","imageRefs","reset","state","imageSizes","length","loadImage","offsetX","positionXNumber","standardPositionX","positionX","setValue","offsetXRTL","I18nManager","isRTL","currentShowIndex","props","imageUrls","vx","vxRTL","isLeftMove","flipThreshold","isRightMove","goBack","call","goNext","resetPosition","width","timing","toValue","duration","pageAnimateTime","useNativeDriver","start","nextIndex","setState","onChange","image","saveToLocalByLongPress","isShowMenu","onLongPress","onClick","handleCancel","onDoubleClick","hasLayout","onCancel","event","nativeEvent","layout","height","style","styles","backgroundColor","forceUpdate","jumpToCurrentImage","onSave","CameraRoll","saveToCameraRoll","url","onSaveToCamera","onSwipeDown","componentDidMount","init","getDerivedStateFromProps","nextProps","prevState","prevIndexProp","componentDidUpdate","prevProps","fadeAnim","reloadAllLoadedImage","Array","from","loadedIndex","keys","imageStatus","saveImageSizeRegardlessImageState","slice","Image","getSize","status","data","resolveAssetSource","source","newError","forEach","imageUrl","push","has","set","saveImageSize","imageLoaded","startsWith","enablePreload","prefetch","getContent","screenWidth","screenHeight","ImageElements","map","handleLongPressWithIndex","handleLongPress","bind","imageInfo","widthPixel","HeightPixel","Wrapper","children","others","maxOverflow","handleHorizontalOuterRangeOffset","handleResponderRelease","onMove","get","handleClick","handleDoubleClick","enableSwipeDown","swipeDownThreshold","handleSwipeDown","enableImageZoom","doubleClickInterval","modalContainer","loadingContainer","loadingRender","imageStyle","uri","preloadImage","el","minScale","maxScale","renderImage","failImageSource","zIndex","container","opacity","renderHeader","arrowLeftContainer","renderArrowLeft","arrowRightContainer","renderArrowRight","moveBox","transform","translateX","renderIndicator","originSizeKb","originUrl","watchOrigin","watchOriginTouchable","watchOriginText","bottom","position","footerContainerStyle","renderFooter","getMenu","menus","menuContainer","cancel","handleLeaveMenu","saveToLocal","menuShadow","menuContent","operateContainer","operateText","menuContext","render","childs","flex","handleLayout","overflow","Props"],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport {\n  Animated,\n  CameraRoll,\n  I18nManager,\n  Image,\n  Text,\n  TouchableHighlight,\n  TouchableOpacity,\n  TouchableWithoutFeedback,\n  View,\n} from 'react-native';\nimport ImageZoom from 'react-native-image-pan-zoom';\nimport styles from './image-viewer.style';\nimport { IImageInfo, IImageSize, Props, State } from './image-viewer.type';\n\nexport default class ImageViewer extends React.Component<Props, State> {\n  public static defaultProps = new Props();\n  public state = new State();\n\n  // 背景透明度渐变动画\n  private fadeAnim = new Animated.Value(0);\n\n  // 当前基准位置\n  private standardPositionX = 0;\n\n  // 整体位移，用来切换图片用\n  private positionXNumber = 0;\n  private positionX = new Animated.Value(0);\n\n  private width = 0;\n  private height = 0;\n\n  private styles = styles(0, 0, 'transparent');\n\n  // 是否执行过 layout. fix 安卓不断触发 onLayout 的 bug\n  // @ts-ignore\n  private hasLayout = false;\n\n  // 记录已加载的图片 index\n  private loadedIndex = new Map<number, boolean>();\n\n  private handleLongPressWithIndex = new Map<number, any>();\n\n  private imageRefs: any[] = [];\n\n  public componentDidMount() {\n    this.init(this.props);\n  }\n\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n    if (nextProps.index !== prevState.prevIndexProp) {\n      return {\n        currentShowIndex: nextProps.index,\n        prevIndexProp: nextProps.index,\n      };\n    }\n    return null;\n  }\n\n  public componentDidUpdate(prevProps: Props) {\n    if (prevProps.index !== this.props.index) {\n      // 立刻预加载要看的图\n      this.loadImage(this.props.index || 0);\n\n      this.jumpToCurrentImage();\n\n      // 显示动画\n      Animated.timing(this.fadeAnim, {\n        toValue: 1,\n        duration: 200,\n        useNativeDriver: !!this.props.useNativeDriver,\n      }).start();\n    }\n  }\n\n  public reloadAllLoadedImage() {\n    for (let index of Array.from(this.loadedIndex.keys())) {\n      const image = this.props.imageUrls[index];\n      const imageStatus = { ...this!.state!.imageSizes![index] };\n\n      // 保存 imageSize 不管当前是否已经加载成功\n      const saveImageSizeRegardlessImageState = () => {\n        const imageSizes = this!.state!.imageSizes!.slice();\n        imageSizes[index] = imageStatus;\n        this.setState({ imageSizes });\n      };\n      Image.getSize(\n        image.url,\n        (width: number, height: number) => {\n          imageStatus.width = width;\n          imageStatus.height = height;\n          imageStatus.status = 'success';\n          saveImageSizeRegardlessImageState();\n        },\n        () => {\n          try {\n            const data = (Image as any).resolveAssetSource(image.props.source);\n            imageStatus.width = data.width;\n            imageStatus.height = data.height;\n            imageStatus.status = 'success';\n            saveImageSizeRegardlessImageState();\n          } catch (newError) {\n            // Give up..\n            imageStatus.status = 'fail';\n            saveImageSizeRegardlessImageState();\n          }\n        },\n      );\n    }\n  }\n\n  /**\n   * props 有变化时执行\n   */\n  public init(nextProps: Props) {\n    if (nextProps.imageUrls.length === 0) {\n      // 隐藏时候清空\n      this.fadeAnim.setValue(0);\n      return this.setState(new State());\n    }\n\n    // 给 imageSizes 塞入空数组\n    const imageSizes: IImageSize[] = [];\n    nextProps.imageUrls.forEach((imageUrl) => {\n      imageSizes.push({\n        width: imageUrl.width || 0,\n        height: imageUrl.height || 0,\n        status: 'loading',\n      });\n    });\n\n    this.setState(\n      {\n        currentShowIndex: nextProps.index,\n        prevIndexProp: nextProps.index || 0,\n        imageSizes,\n      },\n      () => {\n        // 立刻预加载要看的图\n        this.loadImage(nextProps.index || 0);\n\n        this.jumpToCurrentImage();\n\n        // 显示动画\n        Animated.timing(this.fadeAnim, {\n          toValue: 1,\n          duration: 200,\n          useNativeDriver: !!nextProps.useNativeDriver,\n        }).start();\n      },\n    );\n  }\n\n  /**\n   * reset Image scale and position\n   */\n  public resetImageByIndex = (index: number) => {\n    this.imageRefs[index] && this.imageRefs[index].reset();\n  };\n\n  /**\n   * 调到当前看图位置\n   */\n  public jumpToCurrentImage() {\n    // 跳到当前图的位置\n    this.positionXNumber =\n      this.width *\n      (this.state.currentShowIndex || 0) *\n      (I18nManager.isRTL ? 1 : -1);\n    this.standardPositionX = this.positionXNumber;\n    this.positionX.setValue(this.positionXNumber);\n  }\n\n  /**\n   * 加载图片，主要是获取图片长与宽\n   */\n  public loadImage(index: number) {\n    if (!this!.state!.imageSizes![index]) {\n      return;\n    }\n\n    if (this.loadedIndex.has(index)) {\n      return;\n    }\n    this.loadedIndex.set(index, true);\n\n    const image = this.props.imageUrls[index];\n    const imageStatus = { ...this!.state!.imageSizes![index] };\n\n    // 保存 imageSize\n    const saveImageSize = () => {\n      // 如果已经 success 了，就不做处理\n      if (\n        this!.state!.imageSizes![index] &&\n        this!.state!.imageSizes![index].status !== 'loading'\n      ) {\n        return;\n      }\n\n      const imageSizes = this!.state!.imageSizes!.slice();\n      imageSizes[index] = imageStatus;\n      this.setState({ imageSizes });\n    };\n\n    if (this!.state!.imageSizes![index].status === 'success') {\n      // 已经加载过就不会加载了\n      return;\n    }\n\n    // 如果已经有宽高了，直接设置为 success\n    if (\n      this!.state!.imageSizes![index].width > 0 &&\n      this!.state!.imageSizes![index].height > 0\n    ) {\n      imageStatus.status = 'success';\n      saveImageSize();\n      return;\n    }\n\n    // 是否加载完毕了图片大小\n    // const sizeLoaded = false;\n    // 是否加载完毕了图片\n    let imageLoaded = false;\n\n    // Tagged success if url is started with file:, or not set yet(for custom source.uri).\n    if (!image.url || image.url.startsWith(`file:`)) {\n      imageLoaded = true;\n    }\n\n    // 如果已知源图片宽高，直接设置为 success\n    if (image.width && image.height) {\n      if (this.props.enablePreload && imageLoaded === false) {\n        Image.prefetch(image.url);\n      }\n      imageStatus.width = image.width;\n      imageStatus.height = image.height;\n      imageStatus.status = 'success';\n      saveImageSize();\n      return;\n    }\n\n    Image.getSize(\n      image.url,\n      (width: number, height: number) => {\n        imageStatus.width = width;\n        imageStatus.height = height;\n        imageStatus.status = 'success';\n        saveImageSize();\n      },\n      () => {\n        try {\n          const data = (Image as any).resolveAssetSource(image.props.source);\n          imageStatus.width = data.width;\n          imageStatus.height = data.height;\n          imageStatus.status = 'success';\n          saveImageSize();\n        } catch (newError) {\n          // Give up..\n          imageStatus.status = 'fail';\n          saveImageSize();\n        }\n      },\n    );\n  }\n\n  /**\n   * 预加载图片\n   */\n  public preloadImage = (index: number) => {\n    if (index < this.state.imageSizes!.length) {\n      this.loadImage(index + 1);\n    }\n  };\n  /**\n   * 触发溢出水平滚动\n   */\n  public handleHorizontalOuterRangeOffset = (offsetX: number = 0) => {\n    this.positionXNumber = this.standardPositionX + offsetX;\n    this.positionX.setValue(this.positionXNumber);\n\n    const offsetXRTL = !I18nManager.isRTL ? offsetX : -offsetX;\n\n    if (offsetXRTL < 0) {\n      if (\n        this!.state!.currentShowIndex ||\n        0 < this.props.imageUrls.length - 1\n      ) {\n        this.loadImage((this!.state!.currentShowIndex || 0) + 1);\n      }\n    } else if (offsetXRTL > 0) {\n      if (this!.state!.currentShowIndex || 0 > 0) {\n        this.loadImage((this!.state!.currentShowIndex || 0) - 1);\n      }\n    }\n  };\n\n  /**\n   * 手势结束，但是没有取消浏览大图\n   */\n  public handleResponderRelease = (vx: number = 0) => {\n    const vxRTL = I18nManager.isRTL ? -vx : vx;\n    const isLeftMove = I18nManager.isRTL\n      ? this.positionXNumber - this.standardPositionX <\n      -(this.props.flipThreshold || 0)\n      : this.positionXNumber - this.standardPositionX >\n      (this.props.flipThreshold || 0);\n    const isRightMove = I18nManager.isRTL\n      ? this.positionXNumber - this.standardPositionX >\n      (this.props.flipThreshold || 0)\n      : this.positionXNumber - this.standardPositionX <\n      -(this.props.flipThreshold || 0);\n\n    if (vxRTL > 0.7) {\n      // 上一张\n      this.goBack.call(this);\n\n      // 这里可能没有触发溢出滚动，为了防止图片不被加载，调用加载图片\n      if (this.state.currentShowIndex || 0 > 0) {\n        this.loadImage((this.state.currentShowIndex || 0) - 1);\n      }\n      return;\n    } else if (vxRTL < -0.7) {\n      // 下一张\n      this.goNext.call(this);\n      if (this.state.currentShowIndex || 0 < this.props.imageUrls.length - 1) {\n        this.loadImage((this.state.currentShowIndex || 0) + 1);\n      }\n      return;\n    }\n\n    if (isLeftMove) {\n      // 上一张\n      this.goBack.call(this);\n    } else if (isRightMove) {\n      // 下一张\n      this.goNext.call(this);\n      return;\n    } else {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n  };\n\n  /**\n   * 到上一张\n   */\n  public goBack = () => {\n    if (this.state.currentShowIndex === 0) {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n\n    this.positionXNumber = !I18nManager.isRTL\n      ? this.standardPositionX + this.width\n      : this.standardPositionX - this.width;\n    this.standardPositionX = this.positionXNumber;\n    Animated.timing(this.positionX, {\n      toValue: this.positionXNumber,\n      duration: this.props.pageAnimateTime,\n      useNativeDriver: !!this.props.useNativeDriver,\n    }).start();\n\n    const nextIndex = (this.state.currentShowIndex || 0) - 1;\n\n    this.setState(\n      {\n        currentShowIndex: nextIndex,\n      },\n      () => {\n        if (this.props.onChange) {\n          this.props.onChange(this.state.currentShowIndex);\n        }\n      },\n    );\n  };\n\n  /**\n   * 到下一张\n   */\n  public goNext = () => {\n    if (this.state.currentShowIndex === this.props.imageUrls.length - 1) {\n      // 回到之前的位置\n      this.resetPosition.call(this);\n      return;\n    }\n\n    this.positionXNumber = !I18nManager.isRTL\n      ? this.standardPositionX - this.width\n      : this.standardPositionX + this.width;\n    this.standardPositionX = this.positionXNumber;\n    Animated.timing(this.positionX, {\n      toValue: this.positionXNumber,\n      duration: this.props.pageAnimateTime,\n      useNativeDriver: !!this.props.useNativeDriver,\n    }).start();\n\n    const nextIndex = (this.state.currentShowIndex || 0) + 1;\n\n    this.setState(\n      {\n        currentShowIndex: nextIndex,\n      },\n      () => {\n        if (this.props.onChange) {\n          this.props.onChange(this.state.currentShowIndex);\n        }\n      },\n    );\n  };\n\n  /**\n   * 回到原位\n   */\n  public resetPosition() {\n    this.positionXNumber = this.standardPositionX;\n    Animated.timing(this.positionX, {\n      toValue: this.standardPositionX,\n      duration: 150,\n      useNativeDriver: !!this.props.useNativeDriver,\n    }).start();\n  }\n\n  /**\n   * 长按\n   */\n  public handleLongPress = (image: IImageInfo) => {\n    if (this.props.saveToLocalByLongPress) {\n      // 出现保存到本地的操作框\n      this.setState({ isShowMenu: true });\n    }\n\n    if (this.props.onLongPress) {\n      this.props.onLongPress(image);\n    }\n  };\n\n  /**\n   * 单击\n   */\n  public handleClick = () => {\n    if (this.props.onClick) {\n      this.props.onClick(this.handleCancel, this.state.currentShowIndex);\n    }\n  };\n\n  /**\n   * 双击\n   */\n  public handleDoubleClick = () => {\n    if (this.props.onDoubleClick) {\n      this.props.onDoubleClick(this.handleCancel);\n    }\n  };\n\n  /**\n   * 退出\n   */\n  public handleCancel = () => {\n    this.hasLayout = false;\n    if (this.props.onCancel) {\n      this.props.onCancel();\n    }\n  };\n\n  /**\n   * 完成布局\n   */\n  public handleLayout = (event: any) => {\n    if (event.nativeEvent.layout.width !== this.width) {\n      this.hasLayout = true;\n\n      this.width = event.nativeEvent.layout.width;\n      //there use passed height fix bug (height not fill screen height)\n      this.height = this.props.style!.height as number;\n      this.styles = styles(\n        this.width,\n        this.height,\n        this.props.backgroundColor || 'transparent',\n      );\n\n      // 强制刷新\n      this.forceUpdate();\n      this.jumpToCurrentImage();\n    }\n  };\n\n  /**\n   * 获得整体内容\n   */\n  public getContent() {\n    // 获得屏幕宽高\n    const screenWidth = this.width;\n    const screenHeight = this.height;\n\n    const ImageElements = this.props.imageUrls.map((image, index) => {\n      if (\n        (this.state.currentShowIndex || 0) > index + 1 ||\n        (this.state.currentShowIndex || 0) < index - 1\n      ) {\n        return (\n          <View\n            key={index}\n            style={{ width: screenWidth, height: screenHeight }}\n          />\n        );\n      }\n\n      if (!this.handleLongPressWithIndex.has(index)) {\n        this.handleLongPressWithIndex.set(\n          index,\n          this.handleLongPress.bind(this, image),\n        );\n      }\n\n      let width =\n        this!.state!.imageSizes![index] &&\n        this!.state!.imageSizes![index].width;\n      let height =\n        this.state.imageSizes![index] && this.state.imageSizes![index].height;\n      const imageInfo = this.state.imageSizes![index];\n\n      if (!imageInfo || !imageInfo.status) {\n        return (\n          <View\n            key={index}\n            style={{ width: screenWidth, height: screenHeight }}\n          />\n        );\n      }\n\n      // 如果宽大于屏幕宽度,整体缩放到宽度是屏幕宽度\n      if (width > screenWidth) {\n        const widthPixel = screenWidth / width;\n        width *= widthPixel;\n        height *= widthPixel;\n      }\n\n      // 如果此时高度还大于屏幕高度,整体缩放到高度是屏幕高度\n      if (height > screenHeight) {\n        const HeightPixel = screenHeight / height;\n        width *= HeightPixel;\n        height *= HeightPixel;\n      }\n\n      const Wrapper = ({ children, ...others }: any) => (\n        <ImageZoom\n          cropWidth={this.width}\n          cropHeight={this.height}\n          maxOverflow={this.props.maxOverflow}\n          horizontalOuterRangeOffset={this.handleHorizontalOuterRangeOffset}\n          responderRelease={this.handleResponderRelease}\n          onMove={this.props.onMove}\n          onLongPress={this.handleLongPressWithIndex.get(index)}\n          onClick={this.handleClick}\n          onDoubleClick={this.handleDoubleClick}\n          enableSwipeDown={this.props.enableSwipeDown}\n          swipeDownThreshold={this.props.swipeDownThreshold}\n          onSwipeDown={this.handleSwipeDown}\n          pinchToZoom={this.props.enableImageZoom}\n          enableDoubleClickZoom={this.props.enableImageZoom}\n          doubleClickInterval={this.props.doubleClickInterval}\n          {...others}\n        >\n          {children}\n        </ImageZoom>\n      );\n\n      switch (imageInfo.status) {\n        case 'loading':\n          return (\n            <Wrapper\n              key={index}\n              style={{\n                ...this.styles.modalContainer,\n                ...this.styles.loadingContainer,\n              }}\n              imageWidth={screenWidth}\n              imageHeight={screenHeight}\n            >\n              <View style={this.styles.loadingContainer}>\n                {this!.props!.loadingRender!()}\n              </View>\n            </Wrapper>\n          );\n        case 'success':\n          if (!image.props) {\n            image.props = {};\n          }\n\n          if (!image.props.style) {\n            image.props.style = {};\n          }\n          image.props.style = {\n            ...this.styles.imageStyle, // User config can override above.\n            ...image.props.style,\n            width,\n            height,\n          };\n\n          if (typeof image.props.source === 'number') {\n            // source = require(..), doing nothing\n          } else {\n            if (!image.props.source) {\n              image.props.source = {};\n            }\n            image.props.source = {\n              uri: image.url,\n              ...image.props.source,\n            };\n          }\n          if (this.props.enablePreload) {\n            this.preloadImage(this.state.currentShowIndex || 0);\n          }\n          return (\n            <ImageZoom\n              key={index}\n              ref={(el) => (this.imageRefs[index] = el)}\n              cropWidth={this.width}\n              cropHeight={this.height}\n              maxOverflow={this.props.maxOverflow}\n              horizontalOuterRangeOffset={this.handleHorizontalOuterRangeOffset}\n              responderRelease={this.handleResponderRelease}\n              onMove={this.props.onMove}\n              onLongPress={this.handleLongPressWithIndex.get(index)}\n              onClick={this.handleClick}\n              onDoubleClick={this.handleDoubleClick}\n              imageWidth={width}\n              imageHeight={height}\n              enableSwipeDown={this.props.enableSwipeDown}\n              swipeDownThreshold={this.props.swipeDownThreshold}\n              onSwipeDown={this.handleSwipeDown}\n              panToMove={!this.state.isShowMenu}\n              pinchToZoom={this.props.enableImageZoom && !this.state.isShowMenu}\n              enableDoubleClickZoom={\n                this.props.enableImageZoom && !this.state.isShowMenu\n              }\n              doubleClickInterval={this.props.doubleClickInterval}\n              minScale={this.props.minScale}\n              maxScale={this.props.maxScale}\n            >\n              {this!.props!.renderImage!(image.props)}\n            </ImageZoom>\n          );\n        case 'fail':\n          return (\n            <Wrapper\n              key={index}\n              style={this.styles.modalContainer}\n              imageWidth={\n                this.props.failImageSource\n                  ? this.props.failImageSource.width\n                  : screenWidth\n              }\n              imageHeight={\n                this.props.failImageSource\n                  ? this.props.failImageSource.height\n                  : screenHeight\n              }\n            >\n              {this.props.failImageSource &&\n              this!.props!.renderImage!({\n                source: {\n                  uri: this.props.failImageSource.url,\n                },\n                style: {\n                  width: this.props.failImageSource.width,\n                  height: this.props.failImageSource.height,\n                },\n              })}\n            </Wrapper>\n          );\n      }\n    });\n\n    return (\n      <Animated.View style={{ zIndex: 9 }}>\n        <Animated.View\n          style={{ ...this.styles.container, opacity: this.fadeAnim }}\n        >\n          {this!.props!.renderHeader!(this.state.currentShowIndex)}\n\n          <View style={this.styles.arrowLeftContainer}>\n            <TouchableWithoutFeedback onPress={this.goBack}>\n              <View>{this!.props!.renderArrowLeft!()}</View>\n            </TouchableWithoutFeedback>\n          </View>\n\n          <View style={this.styles.arrowRightContainer}>\n            <TouchableWithoutFeedback onPress={this.goNext}>\n              <View>{this!.props!.renderArrowRight!()}</View>\n            </TouchableWithoutFeedback>\n          </View>\n\n          <Animated.View\n            style={{\n              ...this.styles.moveBox,\n              transform: [{ translateX: this.positionX }],\n              width: this.width * this.props.imageUrls.length,\n              height: this.height,\n            }}\n          >\n            {ImageElements}\n          </Animated.View>\n          {this!.props!.renderIndicator!(\n            (this.state.currentShowIndex || 0) + 1,\n            this.props.imageUrls.length,\n          )}\n\n          {this.props.imageUrls[this.state.currentShowIndex || 0] &&\n          this.props.imageUrls[this.state.currentShowIndex || 0]\n            .originSizeKb &&\n          this.props.imageUrls[this.state.currentShowIndex || 0]\n            .originUrl && (\n            <View style={this.styles.watchOrigin}>\n              <TouchableOpacity style={this.styles.watchOriginTouchable}>\n                <Text style={this.styles.watchOriginText}>查看原图(2M)</Text>\n              </TouchableOpacity>\n            </View>\n          )}\n          <View\n            style={[\n              { bottom: 0, position: 'absolute', zIndex: 9 },\n              this.props.footerContainerStyle,\n            ]}\n          >\n            {this!.props!.renderFooter!(this.state.currentShowIndex || 0)}\n          </View>\n        </Animated.View>\n      </Animated.View>\n    );\n  }\n\n  /**\n   * 保存当前图片到本地相册\n   */\n  public saveToLocal = () => {\n    if (!this.props.onSave) {\n      CameraRoll.saveToCameraRoll(\n        this.props.imageUrls[this.state.currentShowIndex || 0].url,\n      );\n      this!.props!.onSaveToCamera!(this.state.currentShowIndex);\n    } else {\n      this.props.onSave(\n        this.props.imageUrls[this.state.currentShowIndex || 0].url,\n      );\n    }\n\n    this.setState({ isShowMenu: false });\n  };\n\n  public getMenu() {\n    if (!this.state.isShowMenu) {\n      return null;\n    }\n\n    if (this.props.menus) {\n      return (\n        <View style={this.styles.menuContainer}>\n          {this.props.menus({\n            cancel: this.handleLeaveMenu,\n            saveToLocal: this.saveToLocal,\n          })}\n        </View>\n      );\n    }\n\n    return (\n      <View style={this.styles.menuContainer}>\n        <View style={this.styles.menuShadow} />\n        <View style={this.styles.menuContent}>\n          <TouchableHighlight\n            underlayColor='#F2F2F2'\n            onPress={this.saveToLocal}\n            style={this.styles.operateContainer}\n          >\n            <Text style={this.styles.operateText}>\n              {this.props.menuContext.saveToLocal}\n            </Text>\n          </TouchableHighlight>\n          <TouchableHighlight\n            underlayColor='#F2F2F2'\n            onPress={this.handleLeaveMenu}\n            style={this.styles.operateContainer}\n          >\n            <Text style={this.styles.operateText}>\n              {this.props.menuContext.cancel}\n            </Text>\n          </TouchableHighlight>\n        </View>\n      </View>\n    );\n  }\n\n  public handleLeaveMenu = () => {\n    this.setState({ isShowMenu: false });\n  };\n\n  public handleSwipeDown = () => {\n    if (this.props.onSwipeDown) {\n      this.props.onSwipeDown();\n    }\n    this.handleCancel();\n  };\n\n  public render() {\n    let childs: React.ReactElement<any> = null as any;\n\n    childs = (\n      <View style={{ flex: 1, height: '100%' }}>\n        {this.getContent()}\n        {this.getMenu()}\n      </View>\n    );\n\n    return (\n      <View\n        onLayout={this.handleLayout}\n        style={{\n          flex: 1,\n          overflow: 'hidden',\n          ...this.props.style,\n        }}\n      >\n        {childs}\n      </View>\n    );\n  }\n}\n"]}